(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{7336:(e,s,t)=>{Promise.resolve().then(t.bind(t,9416))},9416:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(3562),r=t(591),l=t(8568),o=t(3337),n=t(9410),c=t(5920);let u=()=>{let[e,s]=(0,r.useState)(5),[t,l]=(0,r.useState)(5),[u,i]=(0,r.useState)(5),d=(0,c.useRouter)(),m=async()=>{if(e&&t&&u)try{let s=n.I.currentUser;s&&(await (0,o.ET)((0,o.hJ)(n.db,"moods"),{employeeId:s.uid,date:new Date().toISOString(),fatigue:e,stress:t,mood:u}),console.log("R\xe9ponse enregistr\xe9e avec succ\xe8s."),d.push("/home"))}catch(e){console.error("Erreur lors de l'enregistrement des r\xe9ponses:",e)}else alert("Veuillez r\xe9pondre \xe0 toutes les questions.")};return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"\xc9valuez votre journ\xe9e"}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("label",{className:"text-lg",children:"Niveau de fatigue"}),(0,a.jsx)("input",{type:"range",min:"1",max:"10",value:e||5,onChange:e=>s(Number(e.target.value)),className:"mt-2 w-64"}),(0,a.jsx)("span",{children:e||5})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("label",{className:"text-lg",children:"Niveau de stress"}),(0,a.jsx)("input",{type:"range",min:"1",max:"10",value:t||5,onChange:e=>l(Number(e.target.value)),className:"mt-2 w-64"}),(0,a.jsx)("span",{children:t||5})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("label",{className:"text-lg",children:"Humeur g\xe9n\xe9rale"}),(0,a.jsx)("input",{type:"range",min:"1",max:"10",value:u||5,onChange:e=>i(Number(e.target.value)),className:"mt-2 w-64"}),(0,a.jsx)("span",{children:u||5})]}),(0,a.jsx)("button",{className:"mt-4 bg-blue-500 text-white font-bold py-2 px-4 rounded",onClick:m,children:"Soumettre"})]})};var i=t(1333),d=t(5416);d.kL.register(d.uw,d.f$,d.ZL,d.Dx,d.u,d.De);let m=()=>{let[e,s]=(0,r.useState)({fatigue:0,stress:0,mood:0}),[t,l]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{let e=(0,o.IO)((0,o.hJ)(n.db,"moods")),t=await (0,o.PL)(e),a=0,r=0,c=0,u=0,i={};t.forEach(e=>{let s=e.data(),t=new Date(s.date).toLocaleDateString();i[t]||(i[t]={fatigue:0,stress:0,mood:0,count:0}),i[t].fatigue+=s.fatigue,i[t].stress+=s.stress,i[t].mood+=s.mood,i[t].count+=1,a+=s.fatigue,r+=s.stress,c+=s.mood,u+=1}),u>0&&s({fatigue:a/u,stress:r/u,mood:c/u});let d=Object.keys(i).map(e=>({date:e,fatigue:i[e].fatigue/i[e].count,stress:i[e].stress/i[e].count,mood:i[e].mood/i[e].count}));l(d)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des r\xe9ponses des employ\xe9s :",e)}})()},[]);let c={labels:t.map(e=>e.date),datasets:[{label:"Fatigue moyenne",data:t.map(e=>e.fatigue),backgroundColor:"rgba(75, 192, 192, 0.6)"},{label:"Stress moyen",data:t.map(e=>e.stress),backgroundColor:"rgba(255, 99, 132, 0.6)"},{label:"Humeur moyenne",data:t.map(e=>e.mood),backgroundColor:"rgba(54, 162, 235, 0.6)"}]};return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Statistiques du jour"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsxs)("p",{children:["Niveau de fatigue moyen : ",e.fatigue.toFixed(1)]}),(0,a.jsxs)("p",{children:["Niveau de stress moyen : ",e.stress.toFixed(1)]}),(0,a.jsxs)("p",{children:["Humeur g\xe9n\xe9rale moyenne : ",e.mood.toFixed(1)]})]}),(0,a.jsx)("div",{className:"w-96 h-64",children:(0,a.jsx)(i.$Q,{data:c})})]})},x=()=>{let[e,s]=(0,r.useState)(null),[t,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=async e=>{try{let t=(0,o.IO)((0,o.hJ)(n.db,"users"),(0,o.ar)("uid","==",e)),a=await (0,o.PL)(t);if(a.empty)console.error("Utilisateur non trouv\xe9 dans Firestore.");else{let e=a.docs[0].data();console.log("R\xf4le de l'utilisateur r\xe9cup\xe9r\xe9 :",e.role),s(e.role)}}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration du r\xf4le :",e)}finally{c(!1)}},t=(0,l.Aj)(n.I,s=>{s?(console.log("Utilisateur connect\xe9 :",s.uid),e(s.uid)):c(!1)});return()=>t()},[]),t)?(0,a.jsx)("div",{className:"text-center",children:"Chargement..."}):e?(0,a.jsxs)("div",{className:"container mx-auto p-4",children:["Employee"===e&&(0,a.jsx)(u,{}),"Manager"===e&&(0,a.jsx)(m,{}),"Employee"!==e&&"Manager"!==e&&(0,a.jsxs)("div",{className:"text-center",children:["R\xf4le non reconnu : ",e]})]}):(0,a.jsx)("div",{className:"text-center",children:"Aucun r\xf4le trouv\xe9 pour l'utilisateur."})}},9410:(e,s,t)=>{"use strict";t.d(s,{I:()=>n,db:()=>c});var a=t(6183),r=t(8568),l=t(3337);let o=(0,a.ZF)({apiKey:"AIzaSyAydn9SYPD76o1rODcyY18EC7Mgo2OojOA",authDomain:"moodly-app-163f1.firebaseapp.com",projectId:"moodly-app-163f1",storageBucket:"moodly-app-163f1.appspot.com",messagingSenderId:"347904279105",appId:"1:347904279105:web:b4182f1bfa17f62c29fcc0"}),n=(0,r.v0)(o),c=(0,l.ad)(o)}},e=>{var s=s=>e(e.s=s);e.O(0,[718,873,781,640,99,18,659,744],()=>s(7336)),_N_E=e.O()}]);